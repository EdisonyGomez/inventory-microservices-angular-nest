<div class="flex items-start justify-between mb-6">
  <div>
    <h3 class="text-lg font-semibold text-gray-900">Agregar Nuevo Producto</h3>
    <p class="text-sm text-gray-500">Complete los detalles para listar un nuevo artículo.</p>
  </div>
  <button type="button" (click)="cancel()" class="text-gray-400 hover:text-gray-600"></button>
</div>

<form [formGroup]="form" (ngSubmit)="submit()" class="space-y-5">
  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Nombre del Producto</label>
    <input
      class="w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
      placeholder="Ej. Auriculares Inalámbricos"
      formControlName="name"
    />
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Precio</label>
      <input 
        type="number" 
        class="w-full rounded-lg border border-gray-300 px-3 py-2 text-sm" 
        formControlName="price" 
        placeholder="0.00"
      />
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Inventario</label>
      <input 
        type="number" 
        class="w-full rounded-lg border border-gray-300 px-3 py-2 text-sm" 
        formControlName="stock" 
        placeholder="0"
      />
    </div>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">Imagen del Producto</label>
    
    <div class="flex flex-col items-center justify-center border-2 border-dashed rounded-xl p-4 text-center bg-gray-50 hover:bg-gray-100 transition-colors relative">
      
      @if (imagePreview) {
        <div class="mb-3">
          <img [src]="imagePreview" class="h-32 w-32 object-cover rounded-lg shadow-md border" alt="Vista previa" />
        </div>
      }

      @if (!imagePreview) {
        <div class="text-gray-400 text-3xl mb-2">☁️</div>
      }
      
      <label class="cursor-pointer">
        <span class="font-medium text-blue-600 hover:underline">
          {{ imagePreview ? 'Cambiar Imagen' : 'Subir Imagen del Producto' }}
        </span>
        <input type="file" class="hidden" (change)="onFileSelected($event)" accept="image/*" />
      </label>
      <p class="text-xs text-gray-400 mt-1">PNG, JPG hasta 5MB</p>
    </div>
  </div>
<!-- 
  @for (error of getFormErrors(); track $index) {
    <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
      <p class="text-sm text-red-600">{{ error }}</p>
    </div>
  } -->

  <div class="flex justify-end gap-3 pt-4 border-t">
    <button 
      type="button" 
      (click)="cancel()" 
      [disabled]="isSubmitting()"
      class="px-4 py-2 rounded-lg text-sm border hover:bg-gray-50 disabled:opacity-30"
    >
      Cancelar
    </button>
    
    <button
      type="submit"
      [disabled]="form.invalid || isSubmitting()"
      class="flex items-center justify-center min-w-[130px] px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-medium disabled:opacity-70 disabled:cursor-not-allowed hover:bg-blue-700 transition-all"
    >
      @if (isSubmitting()) {
        <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
      }
      
      <span>{{ isSubmitting() ? 'Guardando...' : 'Crear Producto' }}</span>
    </button>
  </div>
</form>